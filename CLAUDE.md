# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a **Hugo-based static site blog** for a data engineer's personal website and blog. The site is deployed to **GitHub Pages** at `https://bitterfq.github.io/` using **GitHub Actions** for automated CI/CD.

**Hugo Version**: v0.139.3+extended
**Theme**: [Typo](https://github.com/tomfran/typo) (Git submodule)
**Deployment**: Automated via GitHub Actions on push to `main`

## Key Commands

### Building and Development
```bash
# Run local development server with drafts enabled
hugo server -D

# Run local development server (production mode)
hugo server

# Build site manually (optional - GitHub Actions does this automatically)
hugo

# Clean build artifacts
rm -rf public/ resources/
```

### Content Management
```bash
# Create a new blog post
hugo new content/posts/my-new-post.md

# Create a new page
hugo new content/about.md
```

### Deployment
**Deployment is fully automated via GitHub Actions.** Simply:
```bash
git add content/posts/my-new-post.md
git commit -m "Add new blog post"
git push
```

GitHub Actions will automatically:
1. Build the Hugo site with v0.139.3
2. Deploy to GitHub Pages
3. Site live in ~2 minutes

### Theme Management
```bash
# Update the Typo theme submodule
git submodule update --remote themes/typo

# Initialize submodules (if cloning fresh)
git submodule update --init --recursive
```

## Architecture

### Directory Structure (Clean)
**Source files (edit these):**
- **`content/`** - All markdown content source files
  - `content/posts/` - Blog posts with frontmatter
  - `content/about.md` - About page
  - `content/resume.md` - Resume page
- **`static/`** - Static assets served at site root
  - `static/images/` - Blog images
  - `static/resume.pdf` - Resume PDF
- **`themes/typo/`** - Git submodule containing the Typo theme
- **`config.toml`** - Hugo site configuration
- **`.github/workflows/`** - GitHub Actions CI/CD workflows

**Auto-generated (ignored by Git):**
- **`public/`** - Hugo build output (generated by GitHub Actions)
- **`resources/`** - Hugo cache directory

**Important:** Built files (`public/`, `resources/`) are in `.gitignore` and never committed. Only source files are tracked in Git.

### Configuration
All site configuration lives in **`config.toml`**:
- Site metadata (title, baseURL, description)
- Theme configuration (color palette, appearance)
- Homepage intro text and collection settings
- Navigation menu structure
- Social media links
- Giscus comments integration
- Syntax highlighting settings

### Content Frontmatter Structure
Blog posts use YAML frontmatter:
```yaml
---
title: "Post Title"
date: 2025-02-01T14:00:00-08:00
draft: false
tags: ["tag1", "tag2"]  # Optional
---

Your intro paragraph here. This appears in post listings.

<!--more-->

Full post content after this marker...
```

### Deployment Architecture
This site uses **GitHub Actions** for automated deployment:

1. Developer pushes to `main` branch
2. GitHub Actions workflow (`.github/workflows/deploy.yml`) triggers
3. Workflow checks out code with submodules
4. Installs Hugo v0.139.3
5. Runs `hugo --minify` to build site
6. Deploys `public/` directory to GitHub Pages
7. Site is live at `https://bitterfq.github.io/`

**No manual build or sync steps required.**

### Image Management
- Store images in **`static/images/`**
- Reference in markdown: `![Alt text](/images/filename.jpg)`
- Hugo copies files from `static/` to site root at build time
- Images are accessible at `https://bitterfq.github.io/images/filename.jpg`

### Custom Features
- **Giscus comments**: Integrated via GitHub Discussions
- **Theme switching**: JavaScript for light/dark mode toggle
- **Code copy functionality**: Copy code blocks with one click
- **Mermaid diagrams**: Render diagrams from markdown
- **Responsive typography**: Optimized reading experience

## Important Notes

### Git Submodules
- The theme is a **Git submodule**, not a direct dependency
- **Never edit files in `themes/typo/` directly** - changes will be lost
- To update theme: `git submodule update --remote themes/typo`
- When cloning: Always use `--recursive` flag or run `git submodule update --init --recursive`

### Deployment
- **No manual sync commands needed** - GitHub Actions handles everything
- Push to `main` = automatic deployment
- Check deployment status: https://github.com/bitterfq/bitterfq.github.io/actions
- Typical deployment time: 1-2 minutes

### What NOT to Commit
The following are auto-generated and should never be committed:
- `public/` directory (build output)
- `resources/` directory (Hugo cache)
- Built HTML/CSS/JS files
- `.hugo_build.lock` file

These are handled by `.gitignore`.

### Configuration Notes
- Google Analytics is configured but uses placeholder ID (update if needed)
- Giscus comment system requires GitHub repo Discussions to be enabled
- The site uses **taxonomy for tags** defined in `config.toml`
- Base URL is hardcoded to `https://bitterfq.github.io/`

## Troubleshooting

### Images not displaying
- Verify images are in `static/images/` directory
- Use `/images/filename.jpg` path (with leading slash)
- Check image file permissions (should be readable)

### Deployment failing
- Check GitHub Actions logs: https://github.com/bitterfq/bitterfq.github.io/actions
- Verify Hugo version in workflow matches tested version (v0.139.3)
- Ensure theme submodule is properly initialized

### Theme not working
- Run `git submodule update --init --recursive`
- Verify `themes/typo/` directory is not empty
- Check that `theme = 'typo'` is set in `config.toml`

### Post not appearing
- Ensure `draft: false` in post frontmatter
- Verify date is not in the future
- Check that post is in `content/posts/` directory
